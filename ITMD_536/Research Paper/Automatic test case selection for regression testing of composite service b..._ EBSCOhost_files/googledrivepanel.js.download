(function(a){var h=false;function b(i){a("#googleDriveDialog").trigger("panelClose",a(i.target).data("panel"));}function f(i){i.on("click","[data-upload]",g);i.on("click","[data-close]",b);}function e(){ep.debug("googledrivepanel.js ~ init");var j=a("#googleDriveDialog");f(j);if(!h&&a("[data-auth]").length){var i=a("[data-auth]").data("auth");var l=window.open(i.url,"gdauthentication","width=600;height=600");var k=window.setInterval(function(){try{ep.debug(l.document.URL);if(l.document.URL.indexOf("GoogleAccess/AuthRedirect")>-1){window.clearInterval(k);l.close();h=true;g();}}catch(m){}},500);}}function d(i){ep.debug("googledrivepanel.js ~ Get Content");a.ajax({url:ep.utilities.buildAjaxRequestPath(i,ep.clientData.currentRecord)}).done(function(j){a("#googleDriveDialog").empty().append(j);e();}).fail(function(){ep.debug("Error while loading content");});}function g(){ep.debug("googledrivepanel.js ~ Upload");d("GoogleAccess/UploadFile");}function c(){ep.debug("googledrivepanel.js ~ Create");a("#ToolPanelContent").on("panelReady",function(i,j){if(j==="google-drive"){e();}});e();}a(c);})(jQuery);